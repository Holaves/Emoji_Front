(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[337],{7805:(e,s,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/orderPage",function(){return r(6464)}])},6464:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>u});var a=r(4848),t=r(5368),c=r(9491),o=r(1240),i=r(9377),l=r(6540),d=r(7221),n=r.n(d),h=r(8601),_=r(6715),g=r(4619),x=r(2096);let u=()=>{let[e,s]=(0,l.useState)(!0),[r,d]=(0,l.useState)(""),[u,p]=(0,l.useState)(""),[m,j]=(0,l.useState)([]),[k,v]=(0,l.useState)(!1),[P,N]=(0,l.useState)(1440),[w,T]=(0,l.useState)(""),f=(0,_.useRouter)();(0,l.useEffect)(()=>{N(window.innerWidth),addEventListener("resize",e=>{N(window.innerWidth)})},[]),(0,l.useEffect)(()=>{(async()=>{let e=localStorage.getItem("jwtToken");if(e)try{let s=await fetch("".concat(h.Jc,"/check"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});s.ok||alert("Failed to fetch user data");let r=await s.json();d(r.phone_number),r.adress&&p(r.adress)}catch(e){alert("Error fetching user data:")}})()},[]);let B=async e=>{if(e.length<3){j([]);return}try{let s=await fetch("https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token 66c52997f6014158cde2901f25bc5e8660124013"},body:JSON.stringify({query:e,count:5})});if(!s.ok)throw Error("Failed to fetch address suggestions");let r=await s.json();j(r.suggestions.map(e=>e.value))}catch(e){console.error("Error fetching address suggestions:",e)}},y=e=>{p(e),j([])},O=e=>{d(e.target.value)},b=async()=>{let s=localStorage.getItem("jwtToken");if(s)try{let a=await fetch("".concat(h.Jc,"/orders"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({phone_number:r,adress:u,delive:e,dateTime:w})});201===a.status?f.push("/"):alert("Failed to create order.")}catch(e){console.error("Error creating order:",e),alert("Error creating order.")}else try{let s=(0,g.Xl)(),a=await fetch("".concat(h.Jc,"/orders"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_number:r,adress:u,delive:e,cart:s})});200===a.status||201===a.status?((0,g.sX)(),f.push("/")):alert("Failed to create order.")}catch(e){console.error("Error creating order:",e),alert("Error creating order.")}},[C,S]=(0,l.useState)(!1);return(0,a.jsxs)("div",{className:n().orderPage,children:[(0,a.jsx)(c.A,{order:!0,onChangeDeliveType:e=>{s(e)}}),(0,a.jsxs)(o.A,{styless:{borderRadius:"17px",background:"rgb(247, 247, 247)",marginTop:"150px"},children:[e?(0,a.jsxs)("div",{className:n().orderPage_delive_twoBlocks,children:[(0,a.jsxs)("div",{className:n().orderPage_delive_twoBlocks_touched,children:[(0,a.jsx)("h1",{className:n().orderPageTitle,children:"Ваш заказ:"}),(0,a.jsxs)("div",{className:n().orderPage_input,children:[(0,a.jsx)("h3",{className:n().orderPage_subTItle,children:"Номер:"}),(0,a.jsx)("input",{type:"text",placeholder:"+79001112233",value:r,onChange:O})]}),(0,a.jsxs)("div",{className:n().orderPage_input,children:[(0,a.jsx)("h3",{className:n().orderPage_subTItle,children:"Адрес:"}),(0,a.jsx)("input",{type:"text",value:u,onChange:e=>{let s=e.target.value;s.length<100&&(p(s),B(s))}})]}),(0,a.jsxs)("div",{className:n().orderPage_input,children:[(0,a.jsx)("h3",{className:n().orderPage_subTItle,children:"Дата и время:"}),(0,a.jsx)("input",{type:"datetime-local",value:w,onChange:e=>T(e.target.value)})]}),m.length>0&&(0,a.jsx)("ul",{className:n().suggestionsList,children:m.map((e,s)=>(0,a.jsx)("li",{onClick:()=>y(e),className:n().suggestionItem,children:e},s))}),(0,a.jsxs)("p",{children:["Доставим ваш заказ по адресу: ",(0,a.jsx)("br",{}),u]}),(0,a.jsx)(i.A,{styless:{marginTop:P>1440?"81px":P>1170?"41px":P>1e3?"10px":"30px"},state:u&&r&&k?i.m.active:i.m.disabled,width:P>1170?547:480,height:P>1170?76:P>1e3?55:45,fz:P>1170?"":P>1e3?"25px":"20px",onClickBut:b,children:"Оформить заказ"}),(0,a.jsxs)("div",{className:n().checkBox_block,children:[(0,a.jsx)("div",{className:n().checkBox,onClick:()=>v(!k),children:k&&(0,a.jsx)("div",{className:n().checkBox_icon})}),(0,a.jsx)("h4",{children:"Я ознакомлен с содержанием пользовательского соглашения и принимаю условия обработки персональных данных."})]})]}),P>1e3?(0,a.jsxs)("div",{className:n().orderPage_delive_twoBlocks_cart,children:[(0,a.jsx)("h1",{className:n().orderPageTitle,children:"Товары:"}),(0,a.jsx)("div",{className:n().cart_container,children:(0,a.jsx)(t.A,{isOpenModal:!0,isOrder:!0})})]}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsxs)("div",{className:n().orderPage_delive_twoBlocks,children:[(0,a.jsxs)("div",{className:n().orderPage_delive_twoBlocks_touched,children:[(0,a.jsx)("h1",{className:n().orderPageTitle,children:"Ваш заказ:"}),(0,a.jsxs)("div",{className:n().orderPage_input,children:[(0,a.jsx)("h3",{className:n().orderPage_subTItle,children:"Номер:"}),(0,a.jsx)("input",{type:"text",placeholder:"+79001112233",value:r,onChange:O})]}),m.length>0&&(0,a.jsx)("ul",{className:n().suggestionsList,children:m.map((e,s)=>(0,a.jsx)("li",{onClick:()=>y(e),className:n().suggestionItem,children:e},s))}),(0,a.jsx)(i.A,{styless:{marginTop:P>1440?"81px":P>1170?"41px":P>1e3?"10px":"30px"},state:i.m.active,width:P>1170?547:480,height:P>1170?76:P>1e3?55:45,fz:P>1170?"":P>1e3?"25px":"20px",onClickBut:()=>S(!0),children:"Мы на карте"}),(0,a.jsx)(i.A,{styless:{marginTop:P>1440?"41px":P>1170?"41px":P>1e3?"10px":"30px"},state:r&&k?i.m.active:i.m.disabled,width:P>1170?547:480,height:P>1170?76:P>1e3?55:45,fz:P>1170?"":P>1e3?"25px":"20px",onClickBut:b,children:"Оформить заказ"}),(0,a.jsxs)("div",{className:n().checkBox_block,children:[(0,a.jsx)("div",{className:n().checkBox,onClick:()=>v(!k),children:k&&(0,a.jsx)("div",{className:n().checkBox_icon})}),(0,a.jsx)("h4",{children:"Я ознакомлен с содержанием пользовательского соглашения и принимаю условия обработки персональных данных."})]})]}),P>1e3?(0,a.jsxs)("div",{className:n().orderPage_delive_twoBlocks_cart,children:[(0,a.jsx)("h1",{className:n().orderPageTitle,children:"Товары:"}),(0,a.jsx)("div",{className:n().cart_container,children:(0,a.jsx)(t.A,{isOpenModal:!0,isOrder:!0})})]}):(0,a.jsx)(a.Fragment,{})]}),(0,a.jsx)(x.A,{isOpen:C,setIsOpen:()=>S(!1)})]})]})}},7221:e=>{e.exports={orderPage_delive_twoBlocks:"OrderPage_orderPage_delive_twoBlocks__ZslP9",orderPage_delive_twoBlocks_touched:"OrderPage_orderPage_delive_twoBlocks_touched__hx8XC",orderPageTitle:"OrderPage_orderPageTitle__wDy32",orderPage_input:"OrderPage_orderPage_input__sDHap",checkBox_block:"OrderPage_checkBox_block__BOCWR",checkBox:"OrderPage_checkBox__mbKDS",checkBox_icon:"OrderPage_checkBox_icon__NUTtX",cart_container:"OrderPage_cart_container__U8K9O",suggestionsList:"OrderPage_suggestionsList__x_1nd",ThanksFor:"OrderPage_ThanksFor__HxoNK",Thanks_wrapper:"OrderPage_Thanks_wrapper__9FXda"}}},e=>{var s=s=>e(e.s=s);e.O(0,[106,460,335,424,601,50,636,593,792],()=>s(7805)),_N_E=e.O()}]);