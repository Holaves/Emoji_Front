(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[998],{1984:(t,e,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/categories/[id]",function(){return a(158)}])},5368:(t,e,a)=>{"use strict";a.d(e,{A:()=>I});var r=a(4848),i=a(6540),s=a(9681),c=a.n(s),n=a(8601),l=a(4335);let o="".concat(n.Jc,"/cart"),_=async t=>(await l.A.get(o,{headers:{Authorization:"Bearer ".concat(t)}})).data,d=async(t,e)=>(await l.A.delete("".concat(o),{headers:{Authorization:"Bearer ".concat(t)},data:{DishId:e}})).data,m=async(t,e)=>(await l.A.put("".concat(o,"/quantity/increment"),{DishId:e},{headers:{Authorization:"Bearer ".concat(t)}})).data,h=async(t,e)=>(await l.A.put("".concat(o,"/quantity/decrement"),{DishId:e},{headers:{Authorization:"Bearer ".concat(t)}})).data,u=t=>{let{item:e,onUpdateQuantity:a,onRemove:s,isOrder:l=!1}=t,[o,_]=(0,i.useState)(e.quantity),d=async()=>{if(o>1){let t=o-1;_(t),a(e.dish._id,t);let r=localStorage.getItem("jwtToken");if(r)try{await h(r,String(e.dish._id))}catch(t){console.error("Ошибка при уменьшении количества:",t)}}else C()},u=async()=>{let t=o+1;_(t),a(e.dish._id,t);let r=localStorage.getItem("jwtToken");if(r)try{await m(r,String(e.dish._id))}catch(t){console.error("Ошибка при увеличении количества:",t)}},C=()=>{s(e.dish._id)};return(0,r.jsx)("div",{className:c().CartItem,children:(0,r.jsxs)("div",{className:c().CartItem_wrapper,children:[(0,r.jsx)("div",{className:c().CartItem_img_cont,children:(0,r.jsx)("img",{src:"".concat(n.Jc,"/").concat(e.dish.picture),alt:e.dish.name})}),(0,r.jsxs)("div",{className:c().CartItem_block,children:[(0,r.jsxs)("div",{className:c().CartItem_block_title,children:[(0,r.jsx)("h3",{children:e.dish.name}),(0,r.jsxs)("div",{className:c().CartItem_Counter,style:l?{width:"45px"}:{},children:[!l&&(0,r.jsx)("div",{className:c().decrement,onClick:d,children:(0,r.jsx)("div",{className:c().decrement_first})}),(0,r.jsx)("div",{className:c().counter_text,style:l?{display:"flex",justifyContent:"center",width:"100%"}:{},children:o}),!l&&(0,r.jsxs)("div",{className:c().increment,onClick:u,children:[(0,r.jsx)("div",{className:c().increment_first}),(0,r.jsx)("div",{className:c().increment_second})]})]})]}),(0,r.jsxs)("h2",{className:c().CartBlock_subTitle,children:[e.dish.weight," грамм"]}),(0,r.jsx)("div",{className:c().CartBlock_line}),(0,r.jsxs)("div",{className:c().CartBlock_bot,children:[(0,r.jsxs)("h4",{className:c().CartBlock_price,children:[e.dish.price*o," рублей"]}),l?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)("div",{className:c().dropDish,onClick:C})]})]})]})})};var C=a(9377),x=a(8787),v=a.n(x),p=a(4619),g=a(6715);let I=t=>{let{isOpenModal:e,isOrder:a=!1,cart:s}=t,[c,n]=(0,i.useState)(s||[]),[l,o]=(0,i.useState)(!1),[m,h]=(0,i.useState)(0),[x,I]=(0,i.useState)(1440),j=(0,g.useRouter)();(0,i.useEffect)(()=>{let t=setInterval(async()=>{let t=localStorage.getItem("jwtToken");if(!s){if(t)try{let e=await _(t);n(e.dishes)}catch(t){console.error("Ошибка при периодической загрузке корзины:",t)}else n((0,p.Xl)().dishes)}},2500);return()=>{clearInterval(t)}},[]);let y=async t=>{let e=localStorage.getItem("jwtToken");if(e)try{await d(e,String(t))}catch(t){console.error("Ошибка при удалении блюда:",t)}let a=c.filter(e=>e.dish._id!==t);n(a),localStorage.setItem("cart",JSON.stringify({dishes:a,isDelive:!1}))};(0,i.useEffect)(()=>{I(window.innerWidth),addEventListener("resize",t=>{I(window.innerWidth)})},[]),(0,i.useEffect)(()=>{e?o(!0):setTimeout(()=>o(!1),500)},[e]),(0,i.useEffect)(()=>{0===m&&h(1)},[]);let f=(t,e)=>{if(e<=0){y(t);return}let a=c.map(a=>a.dish._id===t?{...a,quantity:e}:a);n(a),localStorage.setItem("cart",JSON.stringify({dishes:a,isDelive:!1}))};return l?(0,r.jsxs)("div",{className:"".concat(a?v().Cart_order:v().Cart," ").concat(e?v().show:v().hide),children:[!a&&(0,r.jsx)("h2",{className:v().Cart_title,children:"Корзина"}),(0,r.jsx)("div",{className:v().Cart_scroll_text,children:0===c.length?(0,r.jsx)("p",{children:"Ваша корзина пуста"}):c.map((t,e)=>(0,r.jsx)(u,{isOrder:a,item:t,onUpdateQuantity:f,onRemove:y},e))}),(0,r.jsxs)("div",{className:v().Cart_botBlock,children:[(0,r.jsx)("h3",{children:0===c.length?(0,r.jsx)("div",{children:"0 товаров"}):(0,r.jsxs)("div",{children:[c.length," ",c.length>1?"товара":"товар"]})}),(0,r.jsxs)("div",{className:v().Cart_botBlock_sum,children:[(0,r.jsx)("h2",{children:"Общая сумма:"}),(0,r.jsxs)("h4",{children:[c.reduce((t,e)=>t+e.dish.price*e.quantity,0)," ","руб"]})]}),!a&&(0,r.jsx)(C.A,{state:C.m.active,width:x>1520?547:x>1440?430:400,height:x>1440?75:55,fz:x>1520?"":x>1440?"28px":"26px",styless:{margin:"0px auto",marginTop:"20px"},onClickBut:()=>j.push("/orderPage"),children:"Оформить заказ"})]})]}):null}},5820:(t,e,a)=>{"use strict";a.d(e,{A:()=>c});var r=a(4848);a(6540);var i=a(2163),s=a.n(i);let c=t=>{let{children:e,styless:a}=t;return(0,r.jsx)("div",{className:s().ContainerA,style:a,children:e})}},9377:(t,e,a)=>{"use strict";a.d(e,{A:()=>n,m:()=>c});var r=a(4848);a(6540);var i=a(7567),s=a.n(i),c=function(t){return t.disabled="disabled",t.active="active",t}({});let n=t=>{let{children:e,state:a,isAnimation:i,width:c=400,height:n=68,styless:l,onClickBut:o,fz:_}=t;return(0,r.jsx)("button",{className:"active"===a&&!0===i?s().Button_animation_active:"disabled"===a?s().Button_disabled:"active"===a?s().Button_active:void 0,style:{...l,maxWidth:"".concat(c,"px"),height:"".concat(n,"px"),cursor:"disabled"===a?"not-allowed":"pointer","--hover-max-width":"".concat(c+c/10,"px")},onClick:"active"===a&&o?o:void 0,disabled:"disabled"===a,children:(0,r.jsx)("h4",{style:{fontSize:_&&_},children:e})})}},4619:(t,e,a)=>{"use strict";a.d(e,{Xl:()=>r,bE:()=>i,sX:()=>s});let r=()=>{let t=localStorage.getItem("cart");return t?JSON.parse(t):{dishes:[],isDelive:!1}},i=t=>{let e=r(),a=e.dishes.find(e=>e.dish._id===t._id);a?a.quantity+=1:e.dishes.push({dish:t,quantity:1}),localStorage.setItem("cart",JSON.stringify(e))},s=()=>{localStorage.removeItem("cart")}},158:(t,e,a)=>{"use strict";a.r(e),a.d(e,{__N_SSG:()=>d,default:()=>m});var r=a(4848),i=a(1741),s=a(9773),c=a(1658),n=a(8601),l=a(4335),o=a(6715),_=a(6540),d=!0;let m=t=>{let{serverCategoria:e}=t,[a,d]=(0,_.useState)(e),{categories:m}=(0,c.N)(t=>t.categoria||{categories:[],error:""}),h=(0,o.useRouter)();return(0,_.useEffect)(()=>{(async()=>{if(h.query.id)try{let t=await l.A.get("".concat(n.Jc,"/categories/").concat(h.query.id));d(t.data)}catch(t){console.error("Ошибка при обновлении данных категории:",t)}})()},[h.query.id]),(0,r.jsxs)(n.Ay,{children:[(0,r.jsx)(i.A,{categories:m}),(0,r.jsx)("div",{style:{paddingTop:"30px",paddingBottom:"50px"},children:(0,r.jsx)(s.A,{categoria:a,over:(null==a?void 0:a.name)==="Сеты"})})]})}},7567:t=>{t.exports={Button_animation_active:"Button_Button_animation_active__PqYcf",Button_active:"Button_Button_active__6ApmN",Button_disabled:"Button_Button_disabled__I7GQC"}},9681:t=>{t.exports={CartItem:"CartItem_CartItem__dtMWv",CartItem_wrapper:"CartItem_CartItem_wrapper__Lfgp1",CartItem_img_cont:"CartItem_CartItem_img_cont__eRegn",CartItem_block_title:"CartItem_CartItem_block_title__QJNcB",CartItem_Counter:"CartItem_CartItem_Counter__iCOsV",increment:"CartItem_increment__zNs0l",increment_first:"CartItem_increment_first__D025u",increment_second:"CartItem_increment_second__to9av",decrement:"CartItem_decrement__2BsZR",decrement_first:"CartItem_decrement_first__Sspc3",counter_text:"CartItem_counter_text__5ATA7",CartBlock_subTitle:"CartItem_CartBlock_subTitle__d5Z7V",CartBlock_line:"CartItem_CartBlock_line__k4YMX",CartBlock_bot:"CartItem_CartBlock_bot__ONMkm",CartBlock_price:"CartItem_CartBlock_price___awk7",dropDish:"CartItem_dropDish__PUHAy"}},8787:t=>{t.exports={Cart:"Cart_Cart__ToWvy",show:"Cart_show__3I7kW",openCart:"Cart_openCart__mgwEY",hide:"Cart_hide__pPgUi",closeCart:"Cart_closeCart__wsbu5",Cart_title:"Cart_Cart_title__y1fdb",Cart_botBlock:"Cart_Cart_botBlock__8qjYs",Cart_botBlock_sum:"Cart_Cart_botBlock_sum__5ct9M",Cart_scroll_text:"Cart_Cart_scroll_text__u6yP0"}},2163:t=>{t.exports={ContainerA:"ContainerA_ContainerA__MCVMB"}}},t=>{var e=e=>t(t.s=e);t.O(0,[106,460,335,364,601,921,636,593,792],()=>e(1984)),_N_E=t.O()}]);